# 実装計画

- [x] 1. プロジェクトのセットアップと基本構成
  - Vite + React + TypeScript プロジェクトを作成
  - Tailwind CSS と shadcn/ui をセットアップ
  - Vitest と React Testing Library を設定
  - プロジェクトのディレクトリ構造を作成
  - _要件: 全体_

- [x] 2. 型定義とデータモデルの実装
  - [x] 2.1 TypeScript型定義ファイルを作成
    - `src/types/index.ts` に全ての型定義を実装
    - Difficulty, OperationType, Rarity, Pokemon, GridData, AnswerCellState, ChallengeSession, UserData, RewardType, Reward の型を定義
    - 100マス計算形式に対応した型定義（GridData, AnswerCellState）
    - _要件: 全体_

  - [x] 2.2 ポケモンレア度判定ユーティリティを作成
    - `src/utils/pokemonRarity.ts` にレア度判定ロジックを実装
    - PokeAPI の pokemon ID に基づいてレア度を判定
    - 伝説のポケモン、レアポケモン、コモンポケモンの分類
    - _要件: 5.4, 6.2_

- [x] 3. 計算問題生成サービスの実装（TDD）- 100マス計算形式
  - [x] 3.1 ProblemGenerator のテストを作成
    - グリッドデータ生成のテスト（ヘッダー行・列）
    - 簡単モード: 1桁の足し算・引き算のテスト
    - 普通モード: 1桁の掛け算のテスト
    - 難しいモード: 2桁の計算のテスト
    - 回答セル初期化のテスト（100個のセル生成）
    - 正解計算のテスト
    - _要件: 1.1, 1.2, 3.3, 3.4, 3.5_

  - [x] 3.2 ProblemGenerator サービスを実装
    - `src/services/ProblemGenerator.ts` を作成
    - generateGrid メソッドを実装（ヘッダー行・列の生成）
    - initializeAnswerCells メソッドを実装（回答セルの初期化）
    - calculateAnswer メソッドを実装（正解計算）
    - 各難易度に応じた問題生成ロジックを実装
    - _要件: 1.1, 1.2, 3.2, 3.3, 3.4, 3.5_

- [x] 4. LocalStorage サービスの実装（TDD）
  - [x] 4.1 StorageService のテストを作成
    - ユーザーデータの保存・読み込みのテスト
    - デフォルトデータの生成テスト
    - QuotaExceededError ハンドリングのテスト
    - _要件: 7.1, 7.2_

  - [x] 4.2 StorageService を実装
    - `src/services/StorageService.ts` を作成
    - LocalStorage の読み書き処理を実装
    - エラーハンドリングを実装
    - _要件: 7.1, 7.2_

- [x] 5. 報酬計算サービスの実装（TDD）
  - [x] 5.1 RewardCalculator のテストを作成
    - 初クリア報酬のテスト
    - 新記録報酬のテスト
    - ノーミス報酬のテスト
    - 完了報酬のテスト
    - 難易度別のポイント計算テスト
    - _要件: 4.1, 4.2, 4.3, 4.4_

  - [x] 5.2 RewardCalculator サービスを実装
    - `src/services/RewardCalculator.ts` を作成
    - 報酬計算ロジックを実装
    - 難易度別のポイント設定を実装
    - _要件: 4.1, 4.2, 4.3, 4.4_

- [x] 6. PokeAPI サービスの実装（TDD）
  - [x] 6.1 PokeApiService のテストを作成
    - ランダムポケモン取得のテスト
    - IDでポケモン取得のテスト
    - 複数ポケモン取得のテスト
    - レア度判定のテスト
    - エラーハンドリングのテスト（ネットワークエラー、タイムアウト）
    - _要件: 5.4, 6.2_

  - [x] 6.2 PokeApiService を実装
    - `src/services/PokeApiService.ts` を作成
    - PokeAPI との通信処理を実装
    - リトライロジックを実装
    - レア度判定ロジックを実装
    - _要件: 5.4, 6.2_

- [x] 7. ガチャサービスの実装（TDD）
  - [x] 7.1 GachaService のテストを作成
    - ポイント不足時のテスト
    - レア度別の確率テスト
    - PokeApiService との連携テスト
    - ポイント消費のテスト
    - _要件: 5.1, 5.2, 5.3, 5.4, 5.5_

  - [x] 7.2 GachaService を実装
    - `src/services/GachaService.ts` を作成
    - レア度選択ロジックを実装
    - PokeApiService を使用したポケモン取得を実装
    - _要件: 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 8. ユーザーデータ管理 Context の実装（TDD）
  - [x] 8.1 UserContext のテストを作成
    - ユーザーデータの初期化テスト
    - ポイント追加・消費のテスト
    - ポケモン追加のテスト（PokeAPI の ID を使用）
    - 統計更新のテスト
    - _要件: 5.6, 6.1, 7.1, 7.2, 7.4_

  - [x] 8.2 UserContext と Reducer を実装
    - `src/contexts/UserContext.tsx` を作成
    - ユーザーデータの状態管理を実装
    - StorageService との連携を実装
    - _要件: 5.6, 6.1, 7.1, 7.2, 7.4_

- [x] 9. ゲーム状態管理 Context の実装（TDD）
  - [x] 9.1 GameContext のテストを作成
    - セッション開始のテスト（PokeApiService からポケモン取得）
    - 回答検証のテスト
    - タイマー管理のテスト
    - セッション完了のテスト
    - _要件: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 2.4_

  - [x] 9.2 GameContext と Reducer を実装
    - `src/contexts/GameContext.tsx` を作成
    - チャレンジセッションの状態管理を実装
    - ProblemGenerator と PokeApiService との連携を実装
    - _要件: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 2.4_

- [x] 10. 難易度選択画面の実装（TDD）
  - [x] 10.1 DifficultySelector のテストを作成
    - 3つの難易度ボタンの表示テスト
    - 難易度選択時の動作テスト
    - ゲーム開始時のイベント発火テスト
    - ローディング状態の表示テスト（PokeAPI 通信中）
    - _要件: 3.1, 3.2_

  - [x] 10.2 DifficultySelector コンポーネントを実装
    - `src/components/DifficultySelector/DifficultySelector.tsx` を作成
    - shadcn/ui の Button コンポーネントを使用
    - 難易度選択UIを実装
    - PokeAPI 通信中のローディング表示を実装
    - _要件: 3.1, 3.2_

- [x] 11. タイマーコンポーネントの実装（TDD）
  - [x] 11.1 Timer のテストを作成
    - カウントダウン表示のテスト
    - 時間切れ時のイベント発火テスト
    - 残り時間が少ない時の警告表示テスト
    - 電卓UI表示中もタイマーが動作することのテスト
    - _要件: 2.1, 2.2, 2.4, 2.5_

  - [x] 11.2 Timer コンポーネントを実装
    - `src/components/Timer/Timer.tsx` を作成
    - カウントダウンロジックを実装
    - 視覚的な警告表示を実装
    - _要件: 2.1, 2.2, 2.4_

- [x] 12. ヘッダーセルコンポーネントの実装（TDD）
  - [x] 12.1 HeaderCell のテストを作成
    - 数字の表示テスト
    - 読み取り専用（タップ不可）のテスト
    - ヘッダー行・列の視覚的区別のテスト
    - _要件: 1.1_

  - [x] 12.2 HeaderCell コンポーネントを実装
    - `src/components/GameBoard/HeaderCell.tsx` を作成
    - 数字を表示する読み取り専用セル
    - ヘッダー用のスタイリングを実装
    - _要件: 1.1_

- [x] 13. 回答セルコンポーネントの実装（TDD）
  - [x] 13.1 AnswerCell のテストを作成
    - セルのタップ検知テスト
    - 未回答時の表示テスト
    - 正解時の表示テスト（入力した数字を表示）
    - 不正解時の表示テスト
    - 正解時のアニメーションテスト
    - _要件: 1.4, 1.5, 1.6_

  - [x] 13.2 AnswerCell コンポーネントを実装
    - `src/components/GameBoard/AnswerCell.tsx` を作成
    - タップ可能なセルを実装
    - 状態に応じた表示を実装
    - 正解/不正解のフィードバックを実装
    - アニメーション効果を実装
    - _要件: 1.4, 1.5, 1.6_

- [x] 14. 電卓UIコンポーネントの実装（TDD）
  - [x] 14.1 CalculatorModal のテストを作成
    - モーダル/ボトムシート表示のテスト
    - 数字ボタン（0-9）のテスト
    - 削除ボタンのテスト
    - 決定ボタンのテスト
    - ディスプレイエリアの表示テスト
    - 問題表示のテスト（ヘッダー行・列の数字と演算記号）
    - ボタンサイズのテスト（最低44x44px）
    - 外側タップで閉じるテスト
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 8.10_

  - [x] 14.2 CalculatorModal コンポーネントを実装
    - `src/components/GameBoard/CalculatorModal.tsx` を作成
    - shadcn/ui の Sheet コンポーネントを使用
    - 電卓風のUIを実装（3×4グリッド）
    - 数字入力ロジックを実装
    - 削除・決定ボタンを実装
    - タッチフレンドリーな大きなボタンを実装
    - _要件: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 8.10_

- [x] 15. 隠しポケモン画像コンポーネントの実装（TDD）
  - [x] 15.1 HiddenImage のテストを作成
    - 初期状態で画像が隠れているテスト
    - セルが開くと対応部分が表示されるテスト
    - 段階的に画像が見えるテスト
    - PokeAPI から取得した画像URLの表示テスト
    - _要件: 1.3, 1.7_

  - [x] 15.2 HiddenImage コンポーネントを実装
    - `src/components/GameBoard/HiddenImage.tsx` を作成
    - グリッドレイアウトで画像を分割表示
    - セルの状態に応じた表示制御を実装
    - PokeAPI の画像を使用
    - _要件: 1.3, 1.7_

- [x] 16. ゲームボードコンポーネントの実装（TDD）
  - [x] 16.1 GameBoard のテストを作成
    - 100マス計算形式のグリッド表示テスト（ヘッダー行・列 + 10×10回答セル）
    - HeaderCell コンポーネントとの統合テスト
    - AnswerCell コンポーネントとの統合テスト
    - CalculatorModal との統合テスト
    - HiddenImage コンポーネントとの統合テスト
    - セルタップ時の電卓UI表示テスト
    - ゲームフロー全体のテスト
    - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7_

  - [x] 16.2 GameBoard コンポーネントを実装
    - `src/components/GameBoard/GameBoard.tsx` を作成
    - 100マス計算形式のグリッドレイアウトを実装
    - ヘッダー行・列を配置
    - 10×10の回答セルを配置
    - HeaderCell, AnswerCell, CalculatorModal, HiddenImage を統合
    - GameContext との連携を実装
    - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7_

- [x] 17. 報酬表示モーダルの実装（TDD）
  - [x] 17.1 RewardModal のテストを作成
    - 報酬一覧の表示テスト
    - ポケモン獲得演出のテスト
    - ポイント表示のテスト
    - PokeAPI から取得したポケモン情報の表示テスト
    - _要件: 2.3, 4.1, 4.2, 4.3_

  - [x] 17.2 RewardModal コンポーネントを実装
    - `src/components/Rewards/RewardModal.tsx` を作成
    - shadcn/ui の Dialog コンポーネントを使用
    - 報酬表示UIを実装
    - アニメーション演出を実装
    - _要件: 2.3, 4.1, 4.2, 4.3_

- [x] 18. ガチャ画面の実装（TDD）
  - [x] 18.1 GachaView のテストを作成
    - ガチャボタンの表示テスト
    - ポイント不足時のエラー表示テスト
    - ガチャ実行時の動作テスト
    - ポケモン獲得演出のテスト
    - PokeAPI 通信エラー時のハンドリングテスト
    - _要件: 5.1, 5.2, 5.3, 5.5, 5.6_

  - [x] 18.2 GachaView コンポーネントを実装
    - `src/components/Gacha/GachaView.tsx` を作成
    - shadcn/ui の Button, Card コンポーネントを使用
    - GachaService との連携を実装
    - ガチャアニメーションを実装
    - エラーハンドリングを実装
    - _要件: 5.1, 5.2, 5.3, 5.5, 5.6_

- [x] 19. コレクション画面の実装（TDD）
  - [x] 19.1 PokemonCard のテストを作成
    - ポケモン情報の表示テスト
    - 未獲得ポケモンのシルエット表示テスト
    - レア度表示のテスト
    - PokeAPI から取得した画像の表示テスト
    - _要件: 6.2, 6.3_

  - [x] 19.2 PokemonCard コンポーネントを実装
    - `src/components/Collection/PokemonCard.tsx` を作成
    - shadcn/ui の Card コンポーネントを使用
    - ポケモン情報の表示を実装
    - _要件: 6.2, 6.3_

  - [x] 19.3 CollectionView のテストを作成
    - コレクション一覧の表示テスト
    - 完成度表示のテスト
    - レア度フィルタリングのテスト
    - PokeApiService を使用した複数ポケモン取得のテスト
    - _要件: 6.1, 6.2, 6.3, 6.4_

  - [x] 19.4 CollectionView コンポーネントを実装
    - `src/components/Collection/CollectionView.tsx` を作成
    - PokemonCard を使用してグリッド表示
    - フィルタリング機能を実装
    - 完成度表示を実装
    - PokeApiService との連携を実装
    - _要件: 6.1, 6.2, 6.3, 6.4_

- [x] 20. 統計画面の実装（TDD）
  - [x] 20.1 StatsView のテストを作成
    - 最速記録の表示テスト
    - 総プレイ回数の表示テスト
    - 獲得ポイント数の表示テスト
    - 難易度別の統計表示テスト
    - _要件: 7.1, 7.2, 7.3, 7.4_

  - [x] 20.2 StatsView コンポーネントを実装
    - `src/components/Stats/StatsView.tsx` を作成
    - shadcn/ui の Card, Table コンポーネントを使用
    - 統計情報の表示を実装
    - _要件: 7.1, 7.2, 7.3, 7.4_

- [x] 21. メインアプリケーションの統合
  - [x] 21.1 App コンポーネントのテストを作成
    - ルーティングのテスト
    - Context Provider の統合テスト
    - 画面遷移のテスト
    - _要件: 全体_

  - [x] 21.2 App コンポーネントを実装
    - `src/App.tsx` を作成
    - UserContext と GameContext を Provider として配置
    - ナビゲーションを実装
    - 各画面コンポーネントを統合
    - _要件: 全体_

- [x] 22. エラーハンドリングの実装
  - [x] 22.1 ErrorBoundary のテストを作成
    - エラーキャッチのテスト
    - エラー画面表示のテスト
    - PokeAPI エラー時の表示テスト
    - _要件: 全体_

  - [x] 22.2 ErrorBoundary コンポーネントを実装
    - `src/components/ErrorBoundary.tsx` を作成
    - エラーハンドリングロジックを実装
    - ユーザーフレンドリーなエラー画面を実装
    - _要件: 全体_

- [x] 23. E2Eシナリオテストの作成
  - 難易度選択からゲームプレイ、報酬獲得までの完全なフローをテスト
  - 電卓UIを使用した回答入力のテスト
  - ガチャ実行からコレクション確認までのフローをテスト
  - データ永続化の確認テスト
  - PokeAPI との統合テスト
  - _要件: 全体_

- [x] 24. UI/UXの最終調整
  - 子供向けの大きなタッチターゲットを確認（特に電卓UIのボタン）
  - アニメーション効果の調整
  - カラースキームの調整
  - レスポンシブデザインの確認（スマホ・タブレット対応）
  - 電卓UIの使いやすさを確認
  - 100マス計算グリッドの視認性を確認
  - PokeAPI 通信中のローディング表示の最適化
  - _要件: 全体_
  - 子供向けの大きなタッチターゲットを確認
  - アニメーション効果の調整
  - カラースキームの調整
  - レスポンシブデザインの確認
  - PokeAPI 通信中のローディング表示の最適化
  - _要件: 全体_

- [ ] 25. 新しい演算タイプの追加（割り算、剰余、指数）
  - [ ] 25.1 型定義の拡張
    - `src/types/index.ts` に新しい演算タイプを追加（DIVISION, MODULO, EXPONENTIATION）
    - LevelConfig型に新しい属性を追加（divisible, divisorRange, exponentRange, decimalPlaces, allowNegative, allowBorrow, minResult, maxResult, multipleOf）
    - GridData型にallowDecimalフラグを追加
    - _要件: 3.23-3.86, 9.1-9.12_

  - [ ] 25.2 LevelConfigServiceの拡張
    - `src/services/LevelConfigService.ts` を更新
    - レベル1-100の詳細な設定を実装
    - 足し算基礎（レベル1-7）の詳細設定
    - 引き算基礎（レベル8-14）の詳細設定
    - 掛け算基礎（レベル15-20）の詳細設定
    - 割り算基礎（レベル21-30）の詳細設定
    - 剰余計算（レベル31-40）の詳細設定
    - 小数点の足し算・引き算（レベル41-50）の詳細設定
    - 小数点の掛け算・割り算（レベル51-60）の詳細設定
    - 指数計算（レベル61-70）の詳細設定
    - 複合演算（レベル71-80）の詳細設定
    - 究極の挑戦（レベル81-100）の詳細設定
    - _要件: 3.3-3.86_

  - [ ] 25.3 ProblemGeneratorの拡張（TDD）
    - [ ] 25.3.1 割り算問題生成のテストを作成
      - 割り切れる問題のみ生成されることのテスト
      - 除数が0にならないことのテスト
      - 九九の範囲（1桁÷1桁）のテスト
      - 答えが10以上の割り算のテスト
      - 様々な桁数の組み合わせのテスト
      - _要件: 3.23-3.32, 9.1, 9.2_

    - [ ] 25.3.2 割り算問題生成を実装
      - generateDivisionNumbers メソッドを実装
      - 割り切れる数値ペアの生成ロジック
      - 除数の範囲制約の実装
      - _要件: 3.23-3.32, 9.1, 9.2_

    - [ ] 25.3.3 剰余計算問題生成のテストを作成
      - 除数が2以上であることのテスト
      - 被除数が除数以上であることのテスト
      - 様々な除数範囲のテスト
      - _要件: 3.33-3.42, 9.3, 9.4, 9.5_

    - [ ] 25.3.4 剰余計算問題生成を実装
      - generateModuloNumbers メソッドを実装
      - 除数範囲の制約を実装
      - _要件: 3.33-3.42, 9.3, 9.4, 9.5_

    - [ ] 25.3.5 小数点計算問題生成のテストを作成
      - 小数第一位までの数値生成のテスト
      - 小数第二位までの数値生成のテスト
      - 小数点の足し算・引き算のテスト
      - 小数点の掛け算・割り算のテスト
      - 負の数を含む小数の引き算のテスト
      - _要件: 3.43-3.62, 9.9, 9.10_

    - [ ] 25.3.6 小数点計算問題生成を実装
      - generateDecimalNumbers メソッドを実装
      - 小数点以下の桁数制御を実装
      - 小数点計算の答え検証ロジックを実装
      - _要件: 3.43-3.62, 9.9, 9.10_

    - [ ] 25.3.7 指数計算問題生成のテストを作成
      - 底と指数の範囲制約のテスト
      - 計算結果が10000以下になることのテスト
      - 様々な底と指数の組み合わせのテスト
      - _要件: 3.63-3.72, 9.6, 9.7, 9.8_

    - [ ] 25.3.8 指数計算問題生成を実装
      - generateExponentiationNumbers メソッドを実装
      - 底と指数の範囲制約を実装
      - 結果の上限チェックを実装
      - _要件: 3.63-3.72, 9.6, 9.7, 9.8_

    - [ ] 25.3.9 くり上がり/くり下がり制約のテストを作成
      - くり上がりなしの足し算のテスト
      - くり上がりありの足し算のテスト
      - くり下がりなしの引き算のテスト
      - くり下がりありの引き算のテスト
      - _要件: 3.3-3.16, 9.11_

    - [ ] 25.3.10 くり上がり/くり下がり制約を実装
      - hasCarryOver メソッドを実装
      - hasBorrow メソッドを実装
      - 制約に基づく数値生成ロジックを実装
      - _要件: 3.3-3.16, 9.11_

    - [ ] 25.3.11 複合演算問題生成のテストを作成
      - 複数の演算タイプを組み合わせたテスト
      - 小数と整数の混合演算のテスト
      - 指数と四則演算の組み合わせのテスト
      - _要件: 3.73-3.86_

    - [ ] 25.3.12 複合演算問題生成を実装
      - 演算タイプのランダム選択ロジック
      - 数値タイプ（整数/小数）の混合ロジック
      - _要件: 3.73-3.86_

  - [ ] 25.4 電卓UIの拡張（TDD）
    - [ ] 25.4.1 小数点ボタンのテストを作成
      - 小数点ボタンの表示テスト
      - 小数点入力のテスト
      - 複数回の小数点入力を拒否するテスト
      - 小数点を含む答えの検証テスト
      - _要件: 8.11, 8.12, 8.13_

    - [ ] 25.4.2 小数点ボタンを実装
      - CalculatorModalに小数点ボタンを追加
      - 小数点入力ロジックを実装
      - 小数点の重複入力防止を実装
      - _要件: 8.11, 8.12, 8.13_

    - [ ] 25.4.3 新しい演算記号の表示テストを作成
      - 割り算記号（÷）の表示テスト
      - 剰余記号（mod）の表示テスト
      - 指数記号（^）の表示テスト
      - _要件: 9.7_

    - [ ] 25.4.4 新しい演算記号の表示を実装
      - getOperationSymbol メソッドを更新
      - 各演算タイプに対応する記号を追加
      - _要件: 9.7_

  - [ ] 25.5 答え検証ロジックの拡張（TDD）
    - [ ] 25.5.1 割り算の答え検証テストを作成
      - 割り切れる答えの検証テスト
      - 小数点を含む割り算の答え検証テスト
      - _要件: 9.1_

    - [ ] 25.5.2 剰余計算の答え検証テストを作成
      - 余りの正確性検証テスト
      - 除数が0の場合のエラーハンドリングテスト
      - _要件: 9.3, 9.5_

    - [ ] 25.5.3 指数計算の答え検証テストを作成
      - 累乗の正確性検証テスト
      - 大きな結果の処理テスト
      - _要件: 9.6, 9.8_

    - [ ] 25.5.4 小数点計算の答え検証テストを作成
      - 小数点以下の桁数の正確性テスト
      - 丸め誤差の処理テスト
      - _要件: 9.10_

    - [ ] 25.5.5 負の数の答え検証テストを作成
      - 負の数の答えの正確性テスト
      - 負の数の表示テスト
      - _要件: 9.12_

    - [ ] 25.5.6 答え検証ロジックを実装
      - calculateAnswer メソッドを更新
      - 各演算タイプの計算ロジックを追加
      - 小数点の精度処理を実装
      - 負の数の処理を実装
      - _要件: 9.1-9.12_

  - [ ] 25.6 統合テストの作成
    - 新しい演算タイプを含む完全なゲームフローのテスト
    - レベル1-100のすべてのレベルで問題が正しく生成されることのテスト
    - 各演算タイプの電卓UI操作のテスト
    - _要件: 3.1-3.86, 9.1-9.12_

  - [ ] 25.7 UI/UXの調整
    - 新しい演算記号の視認性を確認
    - 小数点ボタンの配置とサイズを調整
    - 指数表記の読みやすさを確認
    - 剰余計算の説明表示を追加
    - _要件: 全体_

## 追加タスク（オプション）

- [ ] 26. TypeScriptビルドエラーの修正
  - テストファイルのTypeScriptエラーを修正
  - 未使用のimportを削除
  - global型定義の問題を解決
  - _要件: 全体_

- [ ] 27. パフォーマンス最適化
  - React.memoを使用してコンポーネントの再レンダリングを最適化
  - useMemoとuseCallbackで計算とコールバックをメモ化
  - 画像の遅延読み込みを実装
  - _要件: 全体_

- [ ] 28. アクセシビリティの向上
  - ARIA属性の追加と改善
  - キーボードナビゲーションの強化
  - スクリーンリーダー対応の改善
  - _要件: 全体_

- [ ] 29. エラーメッセージの多言語対応
  - エラーメッセージを日本語で統一
  - ユーザーフレンドリーなエラー表示の改善
  - _要件: 全体_


- [-] 30. データエクスポート/インポート機能の実装
  - ユーザーデータを別の端末に引き継ぐためのエクスポート/インポート機能を実装
  - _要件: 10.1-10.12_

  - [ ] 30.1 StorageServiceにエクスポート機能を追加
    - exportUserData メソッドを実装
      - 現在のユーザーデータを取得
      - バージョン情報とタイムスタンプを追加
      - ExportData 型のオブジェクトを返す
    - downloadExportFile メソッドを実装
      - JSON文字列に変換
      - Blobを作成してダウンロード
      - ファイル名にタイムスタンプを含める
    - _要件: 10.1, 10.2, 10.3, 10.4_

  - [ ] 30.2 StorageServiceにインポート機能を追加
    - validateImportData メソッドを実装
      - バージョン情報の検証
      - userDataの存在確認
      - 必須フィールドのチェック（points, ownedPokemon, highestUnlockedLevel, levelStats）
      - データ型の検証
      - 値の範囲チェック
    - importUserData メソッドを実装
      - データを検証
      - 検証成功時にローカルストレージに保存
      - エラー時に例外をスロー
    - _要件: 10.5, 10.7, 10.8, 10.9, 10.11_

  - [x] 30.3 ExportData型を定義
    - types/index.ts に ExportData インターフェースを追加
      - version: string
      - exportDate: string
      - userData: UserData
    - _要件: 10.4_

  - [ ] 30.4 StatsViewにデータ管理UIを追加
    - 「データ管理」セクションを作成
    - エクスポートボタンを追加
      - ボタンクリック時に downloadExportFile を呼び出す
      - 成功メッセージを表示
      - エラー時にエラーメッセージを表示
    - インポートボタンを追加
      - ファイル入力要素を非表示で配置
      - ボタンクリック時にファイル選択ダイアログを開く
    - _要件: 10.1, 10.5, 10.12_

  - [ ] 30.5 インポート確認ダイアログを実装
    - ファイル選択時の処理を実装
      - ファイルを読み込み
      - JSONをパース
      - データを検証
      - 検証成功時に確認ダイアログを表示
      - 検証失敗時にエラーメッセージを表示
    - 確認ダイアログコンポーネントを作成
      - 既存データが上書きされることを警告
      - 確認ボタンとキャンセルボタンを配置
    - 確認時の処理を実装
      - importUserData を呼び出す
      - 成功時にページをリロード
      - エラー時にエラーメッセージを表示
    - _要件: 10.6, 10.8, 10.9, 10.10, 10.11_

  - [ ] 30.6 エラーハンドリングの実装
    - ファイル読み込みエラーの処理
    - JSON解析エラーの処理
    - データ検証エラーの処理
    - 保存エラーの処理
    - ユーザーフレンドリーなエラーメッセージを表示
    - _要件: 10.11_

  - [ ]* 30.7 プロパティベーステストの作成
    - **Property 1: エクスポートデータの完全性**
      - ランダムなユーザーデータを生成
      - エクスポートしたデータに全ての必須フィールドが含まれることを検証
      - **Validates: Requirements 10.4**
    
    - **Property 2: インポート/エクスポートのラウンドトリップ**
      - ランダムなユーザーデータを生成
      - エクスポートしてからインポート
      - 元のデータと同じ状態になることを検証
      - **Validates: Requirements 10.2, 10.9**
    
    - **Property 3: 不正データの拒否**
      - 不正なフォーマットのデータを生成
      - インポート時に検証エラーが発生することを検証
      - データが保存されないことを検証
      - **Validates: Requirements 10.11**
    
    - **Property 4: ファイル名の一意性**
      - 複数回エクスポートを実行
      - 各ファイル名にタイムスタンプが含まれることを検証
      - ファイル名が区別できることを検証
      - **Validates: Requirements 10.3**

  - [ ]* 30.8 ユニットテストの作成
    - StorageService.exportUserData のテスト
    - StorageService.validateImportData のテスト
    - StorageService.importUserData のテスト
    - エラーケースのテスト
    - _要件: 10.1-10.11_

  - [ ] 30.9 統合テストの作成
    - エクスポート→インポートの完全なフローのテスト
    - UI操作のテスト（ボタンクリック、ファイル選択、確認ダイアログ）
    - エラーケースのテスト
    - _要件: 10.1-10.12_

  - [ ] 30.10 UI/UXの調整
    - ボタンのデザインとレイアウトを調整
    - エラーメッセージの表示スタイルを統一
    - 確認ダイアログのデザインを改善
    - 成功メッセージの表示を追加
    - _要件: 10.1-10.12_
