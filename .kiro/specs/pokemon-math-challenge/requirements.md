# 要件ドキュメント

## はじめに

ポケモン100マス計算チャレンジは、子供向けの教育アプリケーションです。100マス計算を通じて計算力を養いながら、ポケモンの絵を徐々に明らかにし、コレクションを増やすゲーム要素を組み合わせることで、子供たちが繰り返し挑戦したくなる仕組みを提供します。

## 用語集

- **アプリケーション**: ポケモン100マス計算チャレンジシステム全体
- **100マスグリッド**: 10×10の回答セルで構成されたグリッド（オリジナルの100マス計算形式）
- **ヘッダー行**: 100マスグリッドの最上部に横に並ぶ10個の数字
- **ヘッダー列**: 100マスグリッドの最左部に縦に並ぶ10個の数字
- **回答セル**: ヘッダー行とヘッダー列の数字を使って計算した答えを入力するセル
- **電卓UI**: セルをタップした際に表示される数字入力用のインターフェース
- **隠しポケモン画像**: 100マスグリッドの背後に配置されたポケモンの絵
- **チャレンジセッション**: ユーザーが開始してから完了または中断するまでの1回の100マス計算の試行
- **報酬システム**: ユーザーの達成に基づいてポイントやポケモンを付与する仕組み
- **ガチャシステム**: ポイントを消費してランダムにポケモンを獲得する仕組み
- **コレクション**: ユーザーが獲得したポケモンの一覧
- **難易度レベル**: 計算問題の複雑さを定義する設定（簡単、普通、難しい）
- **制限時間**: チャレンジセッションを完了するために許可される最大時間

## 要件

### 要件1

**ユーザーストーリー:** 子供として、100マス計算の問題に正解すると隠れているポケモンの絵が少しずつ見えるようにしたい。そうすることで、何のポケモンか当てる楽しみを感じながら計算を続けられる。

#### 受入基準

1. THE アプリケーション SHALL 100マスグリッドの最上部にヘッダー行として10個の数字を横に配置する
2. THE アプリケーション SHALL 100マスグリッドの最左部にヘッダー列として10個の数字を縦に配置する
3. THE アプリケーション SHALL 各回答セルの背後に隠しポケモン画像の一部を配置する
4. WHEN ユーザーが回答セルをタップする, THE アプリケーション SHALL 電卓UIを表示する
5. WHEN ユーザーが電卓UIで正しい答えを入力する, THE アプリケーション SHALL その回答セルを開いて隠しポケモン画像の対応部分を表示する
6. WHEN ユーザーが電卓UIで間違った答えを入力する, THE アプリケーション SHALL その回答セルを閉じたままにする
7. THE アプリケーション SHALL 開いた回答セルの数に応じて隠しポケモン画像の可視部分を段階的に増やす

### 要件2

**ユーザーストーリー:** 子供として、制限時間内に100マス計算を全て解き切ったら、そのポケモンを獲得できるようにしたい。そうすることで、時間内に完了するモチベーションが高まる。

#### 受入基準

1. THE アプリケーション SHALL 各チャレンジセッションに制限時間を設定する
2. WHEN ユーザーがチャレンジセッションを開始する, THE アプリケーション SHALL 残り時間のカウントダウンを表示する
3. WHEN ユーザーが制限時間内に100マスグリッドの全ての回答セルに正解する, THE アプリケーション SHALL 隠しポケモン画像のポケモンをユーザーのコレクションに追加する
4. WHEN 制限時間が終了しユーザーが100マスグリッドを完了していない, THE アプリケーション SHALL チャレンジセッションを終了しポケモンを付与しない
5. WHILE 電卓UIが表示されている, THE アプリケーション SHALL タイマーを継続して動作させる

### 要件3

**ユーザーストーリー:** 子供として、難易度を選択できるようにしたい。そうすることで、自分のレベルに合った問題に挑戦できる。

#### 受入基準

1. THE アプリケーション SHALL 3つの難易度レベル（簡単、普通、難しい）を提供する
2. WHEN ユーザーがチャレンジセッションを開始する前に難易度レベルを選択する, THE アプリケーション SHALL 選択された難易度レベルに応じた計算問題を生成する
3. WHERE 難易度レベルが簡単である, THE アプリケーション SHALL 1桁の足し算と引き算の問題を生成する
4. WHERE 難易度レベルが普通である, THE アプリケーション SHALL 1桁の掛け算の問題を生成する
5. WHERE 難易度レベルが難しいである, THE アプリケーション SHALL 2桁の足し算、引き算、または掛け算の問題を生成する

### 要件4

**ユーザーストーリー:** 子供として、初めてクリアした時、新記録を更新した時、ノーミスで完答した時に特別な報酬がもらえるようにしたい。そうすることで、何度も挑戦する楽しみが増える。

#### 受入基準

1. WHEN ユーザーが特定の難易度レベルで初めてチャレンジセッションを完了する, THE アプリケーション SHALL 初クリア報酬として報酬ポイントをユーザーに付与する
2. WHEN ユーザーが特定の難易度レベルで自己最速記録を更新してチャレンジセッションを完了する, THE アプリケーション SHALL 新記録報酬として報酬ポイントをユーザーに付与する
3. WHEN ユーザーが1つも間違えずにチャレンジセッションを完了する, THE アプリケーション SHALL ノーミス報酬として報酬ポイントをユーザーに付与する
4. THE アプリケーション SHALL 各難易度レベルと達成タイプごとに付与される報酬ポイントの量を定義する

### 要件5

**ユーザーストーリー:** 子供として、獲得したポイントを使ってガチャを引き、レア度の高いポケモンを手に入れたい。そうすることで、コレクションを充実させる楽しみが得られる。

#### 受入基準

1. THE アプリケーション SHALL ユーザーが報酬ポイントを消費してガチャシステムを利用できる機能を提供する
2. WHEN ユーザーがガチャシステムを利用する, THE アプリケーション SHALL 必要な報酬ポイントをユーザーの残高から差し引く
3. WHEN ユーザーがガチャシステムを利用する, THE アプリケーション SHALL レア度に基づいた確率でランダムにポケモンを選択する
4. THE アプリケーション SHALL 少なくとも3つのレア度レベル（コモン、レア、レジェンダリー）を定義する
5. WHEN ガチャシステムがポケモンを選択する, THE アプリケーション SHALL そのポケモンをユーザーのコレクションに追加する
6. THE アプリケーション SHALL ユーザーの現在の報酬ポイント残高を表示する

### 要件6

**ユーザーストーリー:** 子供として、自分が獲得したポケモンのコレクションを見られるようにしたい。そうすることで、達成感を感じられる。

#### 受入基準

1. THE アプリケーション SHALL ユーザーが獲得した全てのポケモンを表示するコレクション画面を提供する
2. THE アプリケーション SHALL コレクション画面で各ポケモンの名前、画像、レア度を表示する
3. THE アプリケーション SHALL コレクション画面でまだ獲得していないポケモンをシルエットまたはロック状態で表示する
4. THE アプリケーション SHALL コレクション画面でユーザーのコレクション完成度（獲得数/総数）を表示する

### 要件7

**ユーザーストーリー:** 子供として、自分の過去の記録や統計を見られるようにしたい。そうすることで、自分の成長を実感できる。

#### 受入基準

1. THE アプリケーション SHALL 各難易度レベルにおけるユーザーの最速クリアタイムを記録する
2. THE アプリケーション SHALL 各難易度レベルにおけるユーザーの総プレイ回数を記録する
3. THE アプリケーション SHALL ユーザーの統計情報を表示する画面を提供する
4. THE アプリケーション SHALL 統計画面で各難易度レベルの最速記録、総プレイ回数、獲得した総ポイント数を表示する

### 要件8

**ユーザーストーリー:** 子供として、スマホやタブレットで簡単に数字を入力できるようにしたい。そうすることで、キーボードを使わずに快適にゲームを楽しめる。

#### 受入基準

1. WHEN ユーザーが回答セルをタップする, THE アプリケーション SHALL 電卓風のUIをモーダルまたはボトムシートとして表示する
2. THE アプリケーション SHALL 電卓UIに0から9までの数字ボタンを配置する
3. THE アプリケーション SHALL 電卓UIに削除ボタンを配置する
4. THE アプリケーション SHALL 電卓UIに決定ボタンを配置する
5. THE アプリケーション SHALL 電卓UIに現在入力中の数字を表示するディスプレイエリアを配置する
6. WHEN ユーザーが数字ボタンをタップする, THE アプリケーション SHALL ディスプレイエリアに数字を追加表示する
7. WHEN ユーザーが削除ボタンをタップする, THE アプリケーション SHALL ディスプレイエリアの最後の数字を削除する
8. WHEN ユーザーが決定ボタンをタップする, THE アプリケーション SHALL 入力された数字を回答として検証する
9. THE アプリケーション SHALL 電卓UIのボタンを子供が押しやすい大きさ（最低44x44px）で表示する
10. WHEN ユーザーが電卓UIの外側をタップする, THE アプリケーション SHALL 電卓UIを閉じる
